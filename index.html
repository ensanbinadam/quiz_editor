<!DOCTYPE html>
<html dir="rtl" lang="ar"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ูุญุฑุฑุงูุฃุณุฆูุฉ ุงูุชูุงุนููุฉ ู ูุฌููุน ุงูููุงุฏ (v21-final)</title>
  <!-- KaTeX -->
  <link rel="stylesheet" href="assets/vendor/cdn.jsdelivr.net-npm-katex_0.16.10-dist-katex.min.756eb65d.css" data-external="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" data-fallback="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css">
  <script src="assets/vendor/cdn.jsdelivr.net-npm-katex_0.16.10-dist-katex.min.ae39a687.js" data-external="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" onerror="this.onerror=null;this.src=this.getAttribute('data-external')" defer=""></script>

  <!-- Quill 1.3.7 -->
  <link href="assets/vendor/cdn.quilljs.com-1.3.7-quill.snow.ae240396.css" rel="stylesheet" data-external="https://cdn.quilljs.com/1.3.7/quill.snow.css" data-fallback="https://cdn.quilljs.com/1.3.7/quill.snow.css">
  <script src="assets/vendor/cdn.quilljs.com-1.3.7-quill.min.7eccb083.js" data-external="https://cdn.quilljs.com/1.3.7/quill.min.js" onerror="this.onerror=null;this.src=this.getAttribute('data-external')" defer=""></script>

  <script src="assets/vendor/cdn.jsdelivr.net-npm-mammoth_1.6.0-mammoth.browser.min.93f4c7c1.js" data-external="https://cdn.jsdelivr.net/npm/mammoth@1.6.0/mammoth.browser.min.js" onerror="this.onerror=null;this.src=this.getAttribute('data-external')" defer=""></script>

  <!-- DOMPurify -->
  <script src="assets/vendor/cdn.jsdelivr.net-npm-dompurify_3.1.6-dist-purify.min.52acb203.js" data-external="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js" onerror="this.onerror=null;this.src=this.getAttribute('data-external')" defer=""></script>

  <!-- Font Awesome -->
  <link rel="stylesheet" href="assets/vendor/cdnjs.cloudflare.com-ajax-libs-font-awesome-6.5.2-css-all.min.3c3af36d.css" data-external="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" data-fallback="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <!-- docx -->
  <script src="assets/vendor/cdn.jsdelivr.net-npm-docx_8.5.0-build-index.umd.2cb5f08.js" data-external="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.js" onerror="this.onerror=null;this.src=this.getAttribute('data-external')" defer=""></script>

  
<link rel="stylesheet" href="assets/css/styles.css" data-splitter="1"><script data-splitter="1" data-splitter-hook="css">
                                        (function(){
                                          function loaded(link){ try{ return !!link.sheet; }catch(e){ return true; } }
                                          function fallback(link){ var alt=document.createElement('link'); alt.rel='stylesheet'; alt.href=link.getAttribute('data-fallback'); document.head.appendChild(alt); }
                                          function hook(){
                                            document.querySelectorAll('link[rel="stylesheet"][data-fallback]').forEach(function(l){
                                              var done=false;
                                              l.addEventListener('error', function(){ if(!done){ done=true; fallback(l); } }, {once:true});
                                              var t=setTimeout(function(){ if(!done && !loaded(l)){ done=true; fallback(l); } }, 1000);
                                              l.addEventListener('load', function(){ clearTimeout(t); }, {once:true});
                                            });
                                          }
                                          if(document.readyState!=='loading') hook(); else document.addEventListener('DOMContentLoaded', hook);
                                        })();</script><script data-splitter="1" data-splitter-hook="css">
                                        (function(){
                                          function loaded(link){ try{ return !!link.sheet; }catch(e){ return true; } }
                                          function fallback(link){ var alt=document.createElement('link'); alt.rel='stylesheet'; alt.href=link.getAttribute('data-fallback'); document.head.appendChild(alt); }
                                          function hook(){
                                            document.querySelectorAll('link[rel="stylesheet"][data-fallback]').forEach(function(l){
                                              var done=false;
                                              l.addEventListener('error', function(){ if(!done){ done=true; fallback(l); } }, {once:true});
                                              var t=setTimeout(function(){ if(!done && !loaded(l)){ done=true; fallback(l); } }, 1000);
                                              l.addEventListener('load', function(){ clearTimeout(t); }, {once:true});
                                            });
                                          }
                                          if(document.readyState!=='loading') hook(); else document.addEventListener('DOMContentLoaded', hook);
                                        })();</script></head>
<body>
  <div class="app-container">
    <header>
      <div class="header-content">
        <div class="logo">
  <div class="logo-icon" aria-label="ูุญุฑุฑ ุงููููุฒ">
  <i class="fa-solid fa-clipboard-question"></i>
</div>
          <div class="logo-text">
            <h1>ูุญุฑุฑ ุงูุฃุณุฆูุฉ ุงูุชูุงุนููุฉ ู ูุฌููุน ุงูููุงุฏ</h1>
            <p>ูุฏุนู ุงููุต ุงูุนุงุฏู/ููุบุฉ html/ูุงููุนุงุฏูุงุช ุงูุฑูุงุถูุฉ</p>
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:10px">
          <span id="lastSavedPill" class="save-pill">ุขุฎุฑ ุญูุธ: โ</span>
          <button class="btn btn-quiet" id="newProjectBtn"><i class="fas fa-file-circle-plus"></i> ูุดุฑูุน ุฌุฏูุฏ</button>
          <button class="btn btn-outline" id="importBtn"><i class="fas fa-file-import"></i> ุงุณุชูุฑุงุฏ JSON</button>
          <input id="importFiles" accept=".json" style="display:none" type="file" multiple="">
        </div>
      </div>
    </header>

    <div class="layout">
      <aside class="sidebar">
        <div class="sidebar-header">
          <h3 class="sidebar-title">ุงูุฃุณุฆูุฉ</h3>
          <div class="sidebar-actions">
            <button id="addQuestionBtn" class="btn btn-quiet"><i class="fas fa-plus"></i> ุฅุถุงูุฉ</button>
            <!-- ุฒุฑ ุงูุชูุฑุงุฑ ุงูุฌุฏูุฏ -->
            <button id="dupQuestionBtn" class="btn btn-quiet" title="ุชูุฑุงุฑ ุงูุณุคุงู ุงูุญุงูู">
              <i class="fas fa-clone"></i> ุชูุฑุงุฑ
            </button>
          </div>
        </div>
        <div id="qList" class="q-list"></div>
      </aside>

      <main class="editor-container">
        <div class="section">
          <div class="section-title"><div class="section-icon"><i class="fas fa-book-reader"></i></div><h3>ุงููุต ุงููุฑุงุฆู</h3></div>
          <!-- HINT: clean & responsive -->
          <div class="hint-block" dir="rtl">
            <div class="hint-lead">ุงูุชุจ ูุตุง ุนุงุฏูุง/ูุชูู/ูุนุงุฏูุงุช:</div>
         
              <span class="item" role="listitem">
                          </span></div>
         
          <div class="editor-row">
            <div class="editor-col">
              <label class="editor-label">ุงููุต ุงููุฑุงุฆู:</label>
              <div id="readingTextEditor" class="text-editor"></div>
              <div class="math-toolbar" style="margin:.5rem 0">
                <button class="btn btn-quiet btn-sm" id="btnInlineFormula">ูุนุงุฏูุฉ ุณุทุฑูุฉ</button>
                <button class="btn btn-quiet btn-sm" id="btnBlockFormula">ูุนุงุฏูุฉ ุนุฑุถูุฉ</button>
              </div>
            </div>
            <div class="editor-col">
              <label class="editor-label">ุงูุตูุฑุฉ:</label>
              <div class="image-upload">
                <div class="image-preview-container" id="readingDropZone">
                  <img id="readingImagePreview" class="image-preview" alt="ูุนุงููุฉ ุงูุตูุฑุฉ">
                  <button id="readingRemoveBtn" class="delete-image-btn" style="display:none"><i class="fas fa-trash"></i> ุญุฐู ุงูุตูุฑุฉ</button>
                </div>
                <div class="image-actions">
                  <button class="btn" id="readingUploadBtn"><i class="fas fa-upload"></i> ุชุญููู ุตูุฑุฉ</button>
                  <button class="btn" id="readingPasteBtn"><i class="fas fa-paste"></i> ูุตู ุตูุฑุฉ</button>
                </div>
              </div>
              <input id="readingImageUpload" accept="image/*" style="display:none" type="file">
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title"><div class="section-icon"><i class="fas fa-question-circle"></i></div><h3>ุงูุณุคุงู</h3></div>
          <div class="editor-row">
            <div class="editor-col">
              <label class="editor-label">ูุต ุงูุณุคุงู:</label>
              <div id="questionTextEditor" class="text-editor"></div>
              <div class="math-toolbar" style="margin:.5rem 0">
                <button type="button" id="qMathInline" class="btn btn-quiet btn-sm">ูุนุงุฏูุฉ ุณุทุฑูุฉ</button>
                <button type="button" id="qMathDisplay" class="btn btn-quiet btn-sm">ูุนุงุฏูุฉ ุนุฑุถูุฉ</button>
              </div>
            </div>
            <div class="editor-col">
              <label class="editor-label">ุตูุฑุฉ ุงูุณุคุงู:</label>
              <div class="image-upload">
                <div class="image-preview-container" id="questionDropZone">
                  <img id="questionImagePreview" class="image-preview" alt="ูุนุงููุฉ ุงูุตูุฑุฉ">
                  <button id="questionRemoveBtn" class="delete-image-btn" style="display:none"><i class="fas fa-trash"></i> ุญุฐู ุงูุตูุฑุฉ</button>
                </div>
                <div class="image-actions">
                  <button class="btn" id="questionUploadBtn"><i class="fas fa-upload"></i> ุชุญููู ุตูุฑุฉ</button>
                  <button class="btn" id="questionPasteBtn"><i class="fas fa-paste"></i> ูุตู ุตูุฑุฉ</button>
                </div>
              </div>
              <input id="questionImageUpload" accept="image/*" style="display:none" type="file">
            </div>
          </div>
        </div>

        <div class="section">
          <div class="section-title"><div class="section-icon"><i class="fas fa-list-ol"></i></div><h3>ุฎูุงุฑุงุช ุงูุฅุฌุงุจุฉ</h3></div>
          <div id="optionsContainer"></div>
          <button id="addOptionBtn" class="btn btn-quiet" style="margin-top:8px"><i class="fas fa-plus"></i> ุฅุถุงูุฉ ุฎูุงุฑ ุฌุฏูุฏ</button>
          <div class="correct-option">
            <label class="editor-label">ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ:</label>
            <select id="correctOptionSelect" class="btn" style="background:#e9ecef;border:1px solid #ced4da;padding:8px 14px"></select>
          </div>
        </div>
      </main>
    </div>

    <div class="import-export">
      <h3 style="text-align:center;margin-top:0;color:var(--secondary)">ุงุณุชูุฑุงุฏ ูุชุตุฏูุฑ ุงูุจูุงูุงุช</h3>

      <textarea id="jsonEditor" class="json-editor" placeholder="ููุง ููุตู JSON ูุฏูููุง (ุงุฎุชูุงุฑู)"></textarea>

      <div class="io-toolbar" style="display:flex;align-items:center;justify-content:space-between;gap:16px;margin:16px 0">
        <div class="io-group" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <button id="exportWordOpen" class="btn btn-warning">
            <i class="fas fa-file-word"></i> ุชุตุฏูุฑ Word (ุฎูุงุฑุงุช)
          </button>
          <button id="exportJsonOpen" class="btn btn-primary">
            <i class="fas fa-file-export"></i> ุชุตุฏูุฑ JSON (ุฎูุงุฑุงุช)
          </button>
        </div>

        <div class="io-group" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap">
          <button id="clearJsonBtn" class="btn btn-quiet">
            <i class="fas fa-eraser"></i> ูุณุญ ุงููุญุชูู
          </button>
          <button id="importJsonBtn" class="btn btn-primary">
            <i class="fas fa-file-import"></i> ุงุณุชูุฑุงุฏ ูู JSON (ูุฏูู)
          </button>
        </div>
      </div>

      <footer dir="rtl" style="text-align:center; font-family: inherit;">
      <p>
          ุจุฑูุฌุฉ :
          <a href="https://t.me/ITG_KSA" target="_blank" rel="noopener">
            ููุชูู ุงูุชุนููู ุงูุชูุงุนูู (ITG) | ุจุงูุชุนุงูู ูุน chatgpt.com 
          </a>
        </p>
        <p>ูุญุฑุฑ ุงูุฃุณุฆูุฉ ุงูุชูุงุนููุฉ ุงููุชูุฏูู | 1447ูู/2025ู</p>
      </footer>
    </div>
  </div>

  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span id="notificationText"></span>
  </div>

  <!-- Modal: ุฎูุงุฑุงุช ุชุตุฏูุฑ Word -->
  <div id="exportModal" class="modal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="exportModalTitle">
      <div class="modal-header">
        <h3 id="exportModalTitle" style="margin:0">ุฎูุงุฑุงุช ุชุตุฏูุฑ Word</h3>
        <button id="closeExportModal" class="btn btn-sm" aria-label="ุฅุบูุงู"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="row hint">ุณูุชู ุฅูุดุงุก <strong>ุฌุฏูู ูุณุชูู ููู ุณุคุงู</strong> ูู <strong>5 ุตููู</strong> ุจุนุฑุถ ุฃุนูุฏุฉ ูุชุณุงููุฉ.</div>
        <div class="modal-grid">
          <label class="field"><span><input type="checkbox" id="optIncludeCover"> ุชุถููู ุบูุงู (ุนููุงู/ูุตู)</span></label>
          <label class="field"><span><input type="checkbox" id="optPageBreak"> ูุงุตู ุตูุญุฉ ุจูู ุงูุฃุณุฆูุฉ</span></label>
          <label class="field"><span><input type="checkbox" id="optShowStar" checked=""> ูุฌูุฉ ุชุญุช ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ</span></label>
          <label class="field"><span><input type="checkbox" id="optIncludeImages" checked=""> ุชุถููู ุงูุตูุฑ ูููุง</span></label>
          <label class="field"><span><input type="checkbox" id="optEqualCols" checked=""> ูุฑุถ ุชุณุงูู ุฃุนูุฏุฉ ุงูุฎูุงุฑุงุช</span></label>
          <label class="field"><span><input type="checkbox" id="optRtlTables" checked=""> ุงุชุฌุงู ุงูุฌุฏุงูู (ูููู โ ูุณุงุฑ)</span></label>

          <label class="field"><span>ูุญุงุฐุงุฉ ุงูุฌุฏูู</span>
            <select id="optTableAlign">
              <option value="right">ูููู</option>
              <option value="center">ูุณุท</option>
              <option value="left">ูุณุงุฑ</option>
            </select>
          </label>

          <label class="field"><span>ุงููุณุงูุฉ ุจูู ุงูุฌุฏุงูู (px)</span>
            <input type="number" id="optTableGap" min="0" value="16">
          </label>

          <label class="field"><span>ุชุณููุฉ ุงูุฎูุงุฑุงุช</span>
            <select id="optOptionLabels">
              <option value="none">ุจุฏูู</option>
              <option value="digits">ูก - ูข - ูฃ - ูค</option>
              <option value="letters">ุฃ - ุจ - ุฌ - ุฏ</option>
            </select>
          </label>

          <label class="field"><span>ุนููุงู ุงูุบูุงู</span>
            <input type="text" id="optCoverTitle" placeholder="ูุซุงู: ุจูู ุฃุณุฆูุฉ ุงููุญุฏุฉ">
          </label>
          <label class="field" style="grid-column:1/3"><span>ูุตู ุงูุบูุงู (ุงุฎุชูุงุฑู)</span>
            <textarea id="optCoverDesc" rows="2" placeholder="ูุซุงู: ุงูุตู ุงูุซุงูุซ โข ูุงุฏุฉ ..."></textarea>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button id="exportWordBtn" class="btn btn-primary">
          <i class="fas fa-file-word"></i> ุชุตุฏูุฑ Word (ุจุณูุท .doc)
        </button>
        <button id="exportDocxBtn" class="btn btn-warning">
          <i class="fas fa-file-export"></i> ุชุตุฏูุฑ Word (ูุชูุฏูู .docx)
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: ุฎูุงุฑุงุช ุชุตุฏูุฑ JSON -->
  <div id="jsonModal" class="modal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="jsonModalTitle">
      <div class="modal-header">
        <h3 id="jsonModalTitle" style="margin:0">ุฎูุงุฑุงุช ุชุตุฏูุฑ JSON</h3>
        <button id="closeJsonModal" class="btn btn-sm" aria-label="ุฅุบูุงู"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="modal-grid">
          <label class="field"><span>ุงูุชูุณูู</span>
            <select id="jsonFormat">
              <option value="plain">ูุต ุนุงุฏู (ููุตู ุจู)</option>
              <option value="html">HTML (ูุญุงูุธ ุนูู ุงูุชูุณูู)</option>
            </select>
          </label>
          <label class="field"><span><input type="checkbox" id="jsonIncludeImages" checked=""> ุชุถููู ุงูุตูุฑ Base64</span>
            <span class="hint">ุฅูุบุงุก ุงูุชุญุฏูุฏ ูุชูููู ุญุฌู ุงูููู.</span>
          </label>
        </div>
      </div>
      <div class="modal-footer">
        <button id="exportJsonBtn" class="btn btn-primary"><i class="fas fa-file-export"></i> ุชุตุฏูุฑ JSON ุงูุขู</button>
      </div>
    </div>
  </div>

<!-- Modal: ุงูุงุณุชูุฑุงุฏ (JSON + Word tabs) -->
<div id="importModal" class="modal" aria-hidden="true">
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="importModalTitle">
    <div class="modal-header">
      <h3 id="importModalTitle" style="margin:0">ุงูุงุณุชูุฑุงุฏ</h3>
      <button id="closeImportModal" class="btn btn-sm" aria-label="ุฅุบูุงู"><i class="fas fa-times"></i></button>

      <!-- ุฃุฒุฑุงุฑ ุงูุชุจููุจ -->
      <div style="display:flex; gap:8px; margin-inline-start:auto">
        <button class="btn imp-tab-btn active" data-target="#impJsonTab">
          <i class="fas fa-code"></i> ุงุณุชูุฑุงุฏ JSON
        </button>
        <button class="btn imp-tab-btn" data-target="#impWordTab">
          <i class="fas fa-file-word"></i> ุงุณุชูุฑุงุฏ Word
        </button>
      </div>
    </div>

    <div class="modal-body">
      <!-- ุชุจููุจ JSON -->
      <div id="impJsonTab" class="imp-tab" style="display:block">
        <div class="field">
          <span>ูุถุน ุงูุงุณุชูุฑุงุฏ</span>
          <div class="radio-row">
            <label><input type="radio" name="importMode" value="append" checked=""> ุฏูุฌ ูุน ุงูุญุงููุฉ</label>
            <label><input type="radio" name="importMode" value="replace"> ุงุณุชุจุฏุงู ุงููู</label>
          </div>
        </div>

        <div class="row" style="margin-top:8px">
          <label style="display:flex;align-items:center;gap:8px">
            <input type="checkbox" id="reviewBeforeImport" checked="">
            <span>ุนุฑุถ ุงูุฅุญุตุงุฆูุฉ ูุจู ุงูุฏูุฌ</span>
          </label>
        </div>

        <div class="row"><hr></div>

        <div class="modal-grid">
          <div class="field">
            <span>ุงุณุชูุฑุงุฏ ูู ูููุงุช (ูููู ุงุฎุชูุงุฑ ุฃูุซุฑ ูู ููู)</span>
            <div>
              <button id="chooseImportFiles" class="btn"><i class="fas fa-folder-open"></i> ุงุฎุชุฑ ูููุงุช JSON</button>
              <div id="importFilesList" class="file-list" style="margin-top:8px;font-size:.9rem;color:#374151"></div>
            </div>
          </div>

          <div class="field">
            <span>ุฃู ุงุณุชูุฑุงุฏ ุจุงููุตู (ุงุฎุชูุงุฑู)</span>
            <textarea id="importTextArea" rows="8" placeholder="ุงูุตู ููุง ูุตูููุฉ JSON ููุฃุณุฆูุฉุ ูุซู:
[
  { &quot;reading&quot;: {&quot;text&quot;:&quot;...&quot;}, &quot;question&quot;: {&quot;text&quot;:&quot;...&quot;}, &quot;options&quot;:[...], &quot;correct&quot;: 2 },
  ...
]"></textarea>
          </div>
        </div>

        <div class="hint">ูููู ุงูุฌูุน ุจูู ุงูุทุฑููุชูู: ุงููููุงุช + ุงููุต ุงูููุตูู ุณูุชู ุชุฌููุนููุง ุญุณุจ ูุถุน ุงูุงุณุชูุฑุงุฏ.</div>
      </div>

      <!-- ุชุจููุจ Word (ููููู ุฅูู ุฏุงุฎู ุงูููุฏุงู) -->
      <div id="impWordTab" class="imp-tab" style="display:none">
        <div class="hint" style="margin:0 0 8px;color:#555">
          ูุฏุนู ูููุงุช .docx (Mammoth) ููููุงุช .doc (HTML ุจุณูุท ููุตุฏูุฑ ูู ุฃุฏุงุชู).
        </div>

        <!-- ุงุฎุชูุงุฑ ุงููููุงุช -->
        <div style="display:flex; align-items:center; gap:10px; flex-wrap:wrap">
          <button class="btn" id="wordChooseFilesBtn">
            <i class="fas fa-folder-open"></i> ุงุฎุชุฑ ูููุงุช Word
          </button>
          <input id="wordFiles" type="file" accept=".doc,.docx" style="display:none" multiple="">
          <div id="wordFilesList" style="display:flex;gap:6px;flex-wrap:wrap"></div>
        </div>

        <!-- ุฅุนุฏุงุฏุงุช ุนุงูุฉ -->
        <div style="margin-top:14px; display:flex; gap:16px; align-items:center; flex-wrap:wrap">
          <label><input type="radio" name="wordImportMode" value="append" checked=""> ุฏูุฌ ูุน ุงูุญุงููุฉ</label>
          <label><input type="radio" name="wordImportMode" value="replace"> ุงุณุชุจุฏุงู ุงููู</label>
          <label><input type="checkbox" id="wordReviewBeforeImport" checked=""> ูุฑุงุฌุนุฉ ูุจู ุงูุฏูุฌ</label>
          <label>ุตููู ููู ุณุคุงู: <input type="number" id="wp_rowsPerQuestion" value="5" min="1" max="20" style="width:80px"></label>
          <label>ุจุญุซ ูุฌูุฉ ูุงุญูุฉ: <input type="number" id="wp_lookahead" value="3" min="0" max="10" style="width:80px"></label>
        </div>

        <!-- ุฅุฒุงูุฉ ุงูุฎูููุฉ (ุงุฎุชูุงุฑู) -->
        <details style="margin-top:10px">
          <summary>๐ผ๏ธ ุฅุฒุงูุฉ ุฎูููุฉ ุงูุตูุฑ (ุงุฎุชูุงุฑู)</summary>
          <div style="margin-top:10px; display:flex; gap:12px; flex-wrap:wrap; align-items:center">
            <label><input type="checkbox" id="wp_bg_enable"> ุชูุนูู</label>
            <label>ุงูููุท:
              <select id="wp_bg_preset">
                <option value="safe">ูุญุงูุธุฉ</option>
                <option value="balanced" selected="">ูุชูุงุฒูุฉ</option>
                <option value="strong">ูููุฉ</option>
              </select>
            </label>
            <label>ุงูุฏุงุฎูู: <input type="number" id="wp_bg_inner" value="18" min="0" max="80" style="width:80px"></label>
            <label>ุงูุฎุงุฑุฌู: <input type="number" id="wp_bg_outer" value="38" min="1" max="100" style="width:80px"></label>
            <label>SS: <input type="number" id="wp_bg_ss" value="2" min="1" max="3" style="width:80px"></label>
            <label>Blur(px): <input type="number" id="wp_bg_blurR" value="1" min="0" max="3" style="width:80px"></label>
            <label>Passes: <input type="number" id="wp_bg_blurP" value="2" min="0" max="3" style="width:80px"></label>
          </div>
        </details>

        <!-- ุฅุญุฏุงุซูุงุช ุงูุงูุชูุงุท -->
        <details style="margin-top:12px" open="">
          <summary>๐ ุฅุญุฏุงุซูุงุช ุงูุฎูุงูุง</summary>
          <div style="margin-top:8px">
            <table class="config-table">
              <thead><tr><th>๐ ูุต ูุฑุงุฆู</th><th>๐ผ๏ธ ุตูุฑุฉ ุงููุต</th><th>โ ุณุคุงู</th><th>๐ผ๏ธ ุตูุฑุฉ ุงูุณุคุงู</th></tr></thead>
              <tbody><tr>
                <td><input type="number" id="wp_r_reading" value="1" min="1"> <input type="number" id="wp_c_reading" value="1" min="1"></td>
                <td><input type="number" id="wp_r_reading_img" value="1" min="1"> <input type="number" id="wp_c_reading_img" value="2" min="1"></td>
                <td><input type="number" id="wp_r_question" value="2" min="1"> <input type="number" id="wp_c_question" value="1" min="1"></td>
                <td><input type="number" id="wp_r_question_img" value="2" min="1"> <input type="number" id="wp_c_question_img" value="2" min="1"></td>
              </tr></tbody>
            </table>

            <h4 style="margin-top:12px">๐งญ ูุตูุต ุงูุฎูุงุฑุงุช</h4>
            <table class="config-table">
              <thead><tr><th>โ</th><th>โก</th><th>โข</th><th>โฃ</th></tr></thead>
              <tbody><tr>
                <td><input type="number" id="wp_r_opt1" value="3" min="1"> <input type="number" id="wp_c_opt1" value="1" min="1"></td>
                <td><input type="number" id="wp_r_opt2" value="3" min="1"> <input type="number" id="wp_c_opt2" value="2" min="1"></td>
                <td><input type="number" id="wp_r_opt3" value="4" min="1"> <input type="number" id="wp_c_opt3" value="1" min="1"></td>
                <td><input type="number" id="wp_r_opt4" value="4" min="1"> <input type="number" id="wp_c_opt4" value="2" min="1"></td>
              </tr></tbody>
            </table>

            <h4 style="margin-top:12px">๐ผ๏ธ ุตูุฑ ุงูุฎูุงุฑุงุช</h4>
            <table class="config-table">
              <thead><tr><th>โ</th><th>โก</th><th>โข</th><th>โฃ</th></tr></thead>
              <tbody><tr>
                <td><input type="number" id="wp_r_opt1_img" value="3" min="1"> <input type="number" id="wp_c_opt1_img" value="3" min="1"></td>
                <td><input type="number" id="wp_r_opt2_img" value="3" min="1"> <input type="number" id="wp_c_opt2_img" value="4" min="1"></td>
                <td><input type="number" id="wp_r_opt3_img" value="4" min="1"> <input type="number" id="wp_c_opt3_img" value="3" min="1"></td>
                <td><input type="number" id="wp_r_opt4_img" value="4" min="1"> <input type="number" id="wp_c_opt4_img" value="4" min="1"></td>
              </tr></tbody>
            </table>

            <div style="text-align:center;margin-top:10px">
              <button class="btn" id="wp_reset">๐ ุฅุนุงุฏุฉ ุชุนููู ุงูุฅุญุฏุงุซูุงุช</button>
            </div>
          </div>
        </details>

        <!-- ุฒุฑ ุงูุชุดุบูู -->
        <div style="margin-top:14px; display:flex; gap:10px; align-items:center">
          <button class="btn btn-primary" id="wordImportRunBtn">
            <i class="fas fa-magic"></i> ุชุญููู &amp; ุงุณุชุนุฑุงุถ
          </button>
          <span class="hint" style="color:#6b7280">ุณุชูุชุญ ุดุงุดุฉ ุงููุฑุงุฌุนุฉ ููุณูุง (ุงูุฅุญุตุงุฆูุงุช + ุฎูุงุฑ ุชุฌุงูู ุงูุตูุฑ ุบูุฑ ุงููุถูููุฉ)</span>
        </div>
      </div>
    </div>

    <!-- ุชุฐููู ุงูููุฏุงู: ุฎุงุต ุจุชุจููุจ JSON -->
    <div class="modal-footer">
      <button id="doImportBtn" class="btn btn-primary"><i class="fas fa-file-import"></i> ุงุณุชูุฑุงุฏ ุงูุขู</button>
    </div>
  </div>
</div>

  <!-- Modal: ูุฑุงุฌุนุฉ ุงูุงุณุชูุฑุงุฏ (ุฅุญุตุงุฆูุฉ + ูุดุงูู) -->
  <div id="importReviewModal" class="modal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="importReviewTitle">
      <div class="modal-header">
        <h3 id="importReviewTitle" style="margin:0">ูุฑุงุฌุนุฉ ุงูุงุณุชูุฑุงุฏ</h3>
        <button id="closeImportReview" class="btn btn-sm" aria-label="ุฅุบูุงู"><i class="fas fa-times"></i></button>
      </div>
      <div class="modal-body">
        <div class="row hint" style="margin-top:0">
          ุชู ุชุญููู ุงููููุงุช ุงูููุญูุฉ. ุฑุงุฌุน ุงูุฅุญุตุงุฆูุฉ ุงูุชุงููุฉ ูุจู ุงูุฏูุฌ.
        </div>

        <div id="revStatsBox" class="field" style="gap:4px"></div>

        <div class="row"><hr></div>

        <div class="field">
          <strong>ููุงุญุธุงุช/ุชุญุฐูุฑุงุช:</strong>
          <div id="revIssuesBox" class="hint" style="line-height:1.7"></div>
        </div>

        <div class="row"><hr></div>

        <label class="field" style="gap:6px">
          <span><input type="checkbox" id="revStripExternal" checked=""> ุชุฌุงูู ุฃู ุตูุฑ ุบูุฑ ูุถููุฉ Base64 (ุชููุน ุฃุฎุทุงุก ุงูุชุตุฏูุฑ)</span>
          <span class="hint">ูููุตุญ ุจุชุฑูู ูููุนูููุง. ุงูุตูุฑ "http/https/blob/file" ุณูุชู ุฅุณูุงุทูุง ุฃุซูุงุก ุงูุฏูุฌ.</span>
        </label>
      </div>
      <div class="modal-footer">
        <button id="cancelImportBtn" class="btn btn-quiet"><i class="fas fa-ban"></i> ุฅูุบุงุก</button>
        <button id="confirmImportBtn" class="btn btn-primary"><i class="fas fa-file-import"></i> ุงุณุชูุฑุงุฏ ุงูุขู</button>
      </div>
    </div>
  </div>

  <!-- Busy Overlay -->
  <div id="busyOverlay" class="busy-overlay" aria-hidden="true">
    <div class="busy-card">
      <div class="spinner" aria-hidden="true"></div>
      <div id="busyText">ุฌุงุฑู ุงููุนุงูุฌุฉ...</div>
    </div>
  </div>

  <!-- Issue Toolbar -->
  <div id="issueToolbar" class="issue-toolbar">
    <span class="issue-count" id="issueCount">0 ูุดุงูู</span>
    <button class="btn btn-sm btn-quiet" id="prevIssueBtn"><i class="fas fa-chevron-right"></i> ุงูุณุงุจู</button>
    <button class="btn btn-sm btn-quiet" id="nextIssueBtn">ุงูุชุงูู <i class="fas fa-chevron-left"></i></button>
    <button class="btn btn-sm btn-quiet" id="dismissIssueBtn">ุชุฌุงูู</button>
    <button class="btn btn-sm btn-quiet" id="showAllIssuesBtn">ุฅุธูุงุฑ ุงููู</button>
  </div>



<script src="assets/js/app.js" defer="" data-splitter="1"></script></body></html>